<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leaflet Map with Legend</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  /* Map container fills viewport */
  #map {
    width: 100%;
    height: 100vh;
    position: relative;
    z-index: 1;
  }

  /* Legend styling */
  #map-legend {
    position: absolute;
    top: 10px;
    right: 10px;
    background: white;
    padding: 10px;
    border-radius: 8px;
    box-shadow: 0 0 8px rgba(0,0,0,0.3);
    z-index: 1000; /* above map */
    pointer-events: auto;
    transition: max-height 0.3s ease;
    overflow: hidden;
    max-height: 40px; /* collapsed height */
  }

  #map-legend.expanded {
    max-height: 400px; /* expanded height */
  }

  #legend-toggle {
    cursor: pointer;
    display: block;
    font-weight: bold;
    margin-bottom: 5px;
  }
</style>
</head>
<body>

<div id="map"></div>

<div id="map-legend">
  <span id="legend-toggle">Toggle Legend</span>
  <div id="legend-content">
    <p>Red Drone: High alert</p>
    <p>Orange Drone: Medium alert</p>
    <p>Yellow Drone: Low alert</p>
    <p>Green Drone: Observed</p>
  </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  // Initialize map
  var map = L.map('map').setView([54.5, 10], 5);

  // Add OpenStreetMap tiles
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  // Legend toggle
  const legend = document.getElementById('map-legend');
  const toggleBtn = document.getElementById('legend-toggle');

  toggleBtn.addEventListener('click', () => {
    legend.classList.toggle('expanded');
    map.invalidateSize(); // refresh map after toggle
  });

  // Icon factory
  function createIcon(file) {
    return L.icon({
      iconUrl: `icons/${file}`,
      iconSize: [32, 32],
      iconAnchor: [18, 36],
      popupAnchor: [0, -30]
    });
  }

  // Example markers
  const droneYellow = createIcon("yellow_drone.png");
  const droneRed = createIcon("red_drone.png");

  L.marker([49.74390, 15.33811], { icon: droneYellow }).addTo(map)
    .bindPopup("<b>Czech Republic ðŸ‡¨ðŸ‡¿</b><br>Drone sighting example.");

  L.marker([55.60913, 12.65098], { icon: droneRed }).addTo(map)
    .bindPopup("<b>Copenhagen, Denmark ðŸ‡©ðŸ‡°</b><br>Drone sighting example.");
</script>

</body>
</html>
